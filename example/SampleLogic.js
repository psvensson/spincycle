// Generated by CoffeeScript 1.8.0
(function() {
  var Game, SampleLogic, e,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  e = require('../lib/EventManager');

  Game = require('./SampleGame');

  SampleLogic = (function() {
    SampleLogic.gamecount = 0;

    function SampleLogic(messageRouter) {
      this.messageRouter = messageRouter;
      this.onListPlayerGames = __bind(this.onListPlayerGames, this);
      this.onNewGame = __bind(this.onNewGame, this);
      this.games = [];
      this.messageRouter.addTarget('listGames', '<noargs>', this.onListPlayerGames);
      this.messageRouter.addTarget('newGame', '<noargs>', this.onNewGame);
    }

    SampleLogic.prototype.onNewGame = function(msg) {
      return new Game({
        name: 'New Game ' + (SampleLogic.gamecount++)
      }).then((function(_this) {
        return function(game) {
          _this.games.push(game);
          return msg.replyFunc({
            status: e.general.SUCCESS,
            info: 'game "' + game.name + '" created'
          });
        };
      })(this));
    };

    SampleLogic.prototype.onListPlayerGames = function(msg) {
      var game, name, rv, _ref;
      rv = [];
      console.log('onListPlayerGames for player ' + msg.user.id);
      _ref = this.games;
      for (name in _ref) {
        game = _ref[name];
        console.log('   onListPlayerGames listing game "' + name + '"');
        rv.push(game.toClient());
      }
      return msg.replyFunc({
        status: e.general.SUCCESS,
        info: '',
        payload: rv
      });
    };

    return SampleLogic;

  })();

  module.exports = SampleLogic;

}).call(this);

//# sourceMappingURL=SampleLogic.js.map
